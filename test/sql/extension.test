# name: test/sql/extension.test
# description: test cached_fs extension loading
# group: [sql]

statement error
SELECT cache_httpfs_get_ondisk_data_cache_size();
----
Catalog Error: Scalar Function with name cache_httpfs_get_ondisk_data_cache_size does not exist!

require cache_httpfs

# Make sure extension description is correctly populated.
query I
SELECT COUNT(*) FROM duckdb_extensions() WHERE extension_name = 'cache_httpfs';
----
1

query I
SELECT * FROM cache_httpfs_list_registered_filesystems();
----
cache_httpfs_HTTPFileSystem
cache_httpfs_HuggingFaceFileSystem
cache_httpfs_S3FileSystem
cache_httpfs_fake_filesystem

statement ok
SELECT cache_httpfs_clear_cache();

query I
SELECT cache_httpfs_get_ondisk_data_cache_size();
----
0

query IIIIII
SELECT * FROM read_csv_auto('https://raw.githubusercontent.com/dentiny/duck-read-cache-fs/refs/heads/main/test/data/stock-exchanges.csv') LIMIT 1;
----
1	Africa	Lesotho	HYBSE	NULL	2019-03-25
